"use strict";(this.webpackChunk_wso2apim_devportal=this.webpackChunk_wso2apim_devportal||[]).push([[943],{1073:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Yt});var a=i(96540),n=i(69067),s=i(11848),l=i(5556),r=i.n(l),o=i(54625),c=i(56347),p=i(90082),d=i(38197),u=i(33551),m=i(58065),g=i(38798),h=i(51989),A=i(30198),f=i(18679),b=i(8843),y=(i(12058),i(5159)),E=i(11240),v=i(84798),S=i(58031),M=i(58763),T=i(22477),x=i(77867),k=i(46831),D=i(22079),w=i(99020),P=i(37738),I=i(1043),R=i(45359),C=i(1403),$=i(71238),N=i(48933);function L(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function O(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const B={FormControl:"ApiKey-FormControl"},q=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{[`& .${B.FormControl}`]:{"margin-bottom":"8px",width:"100%",padding:"0px 10px"}}})),U=e=>{const[t,i]=(0,a.useState)(!0),[n,s]=(0,a.useState)(!1),l=(t,a)=>{const{accessTokenRequest:n,updateAccessTokenRequest:l}=e,r=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?L(Object(i),!0).forEach((function(t){O(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},n),{target:o}=a;switch(t){case"infiniteValidity":i(o.checked),o.checked?r.timeout=-1:r.timeout=null;break;case"timeout":void 0===N.A.number.validate(o.value).error?(r.timeout=o.value,s(!1)):(r.timeout=null,s(!0))}l(r)},{intl:r,accessTokenRequest:o}=e;return a.createElement(q,null,a.createElement(R.A,{variant:"standard",margin:"normal",className:B.FormControl},a.createElement(C.A,{control:a.createElement($.A,{checked:t,onChange:e=>l("infiniteValidity",e),value:o.timeout,color:"grey"}),label:r.formatMessage({defaultMessage:"API Key with infinite validity period",id:"Shared.AppsAndKeys.Tokens.apikey.validity.period.label"})}),!t&&a.createElement(I.A,{variant:"standard",required:!0,label:r.formatMessage({defaultMessage:"API Key validity period",id:"Shared.AppsAndKeys.Tokens.apikey"}),InputLabelProps:{shrink:!0},helperText:n?r.formatMessage({defaultMessage:"Please use a valid number for API Key expiry time",id:"Shared.AppsAndKeys.Tokens.apikey.set.validity.error"}):r.formatMessage({defaultMessage:"You can set an expiration period to determine the validity period of the token after generation. Set this as -1 to ensure that the apikey never expires.",id:"Shared.AppsAndKeys.Tokens.apikey.set.validity.help"}),fullWidth:!0,name:"timeout",onChange:e=>l("timeout",e),placeholder:r.formatMessage({defaultMessage:"Enter time in seconds",id:"Shared.AppsAndKeys.Tokens.apikey.enter.time"}),value:o.timeout,autoFocus:!0,className:B.inputText,error:n})))};U.contextTypes={intl:r().shape({}).isRequired};const W=(0,g.Ay)(U);var K=i(19455),j=i(67034),z=i(56655),_=i(87992),F=i(16718),V=i(49799),H=i(68881),G=i(44448),Y=i(82241),J=i(53215),X=i(41340);const Z="ApiKeyRestriction",Q={FormControl:`${Z}-FormControl`,outterBox:`${Z}-outterBox`,Fab:`${Z}-Fab`},ee=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{[`& .${Q.FormControl}`]:{"margin-bottom":t.spacing(1),width:"100%",padding:t.spacing(0,1)},[`& .${Q.outterBox}`]:{margin:t.spacing(1),padding:t.spacing(1),marginLeft:20,borderColor:"#cccccc"},[`& .${Q.Fab}`]:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}}})),te=e=>{const[t,i]=(0,a.useState)(!1),[s,l]=(0,a.useState)(!1),{intl:r,newIP:o,updateNewIp:c,ipList:p,updateIpList:d,restrictSchema:g,updateRestrictSchema:h,newReferer:A,updateNewReferer:f,refererList:b,updateRefererList:y}=e;return a.createElement(ee,null,a.createElement(n.A,{border:1,borderRadius:"5px",className:Q.outterBox},a.createElement(u.A,{variant:"body1"},a.createElement(m.A,{defaultMessage:"Key Restrictions",id:"Shared.ApiKeyRestriction.key.restrictions"})),a.createElement(R.A,{variant:"standard",component:"fieldset"},a.createElement(X.A,{"aria-label":"API Key Restrictions",value:g,row:!0,onChange:e=>{h(e.target.value),d([]),y([]),c(""),f(""),i(!1),l(!1)}},a.createElement(C.A,{value:"none",control:a.createElement(J.A,{color:"primary",id:"api-key-restriction-none"}),label:r.formatMessage({defaultMessage:"None",id:"Shared.ApiKeyRestriction.key.restrictions.none"}),labelPlacement:"end"}),a.createElement(C.A,{value:"ip",control:a.createElement(J.A,{color:"primary",id:"api-key-restriction-ip"}),label:r.formatMessage({defaultMessage:"IP Addresses",id:"Shared.ApiKeyRestriction.key.restrictions.ip.addresses"}),labelPlacement:"end"}),a.createElement(C.A,{value:"referer",control:a.createElement(J.A,{color:"primary",id:"api-key-restriction-referer"}),label:r.formatMessage({defaultMessage:"HTTP Referrers (Web Sites)",id:"Shared.ApiKeyRestriction.key.restrictions.http.referrers"}),labelPlacement:"end"}))),"ip"===g&&a.createElement(n.A,{component:"div",id:"ipPanel"},a.createElement(w.Ay,{container:!0,direction:"row",spacing:0,justifyContent:"left",alignItems:"left"},a.createElement(w.Ay,{item:!0,md:10,xs:10},a.createElement(I.A,{label:r.formatMessage({defaultMessage:"IP Address",id:"Shared.AppsAndKeys.Tokens.apiKeyRestriction.ip.address.label"}),value:o,onChange:e=>{c(e.target.value.trim()),""===e.target.value.trim()&&i(!1)},className:Q.inputText,helperText:t?r.formatMessage({defaultMessage:"Invalid IP Address",id:"Shared.AppsAndKeys.Tokens.apiKeyRestriction.ip.validity.error"}):"",error:t,size:"small",margin:"dense",variant:"outlined",placeholder:r.formatMessage({defaultMessage:"Enter IP Address",id:"Shared.AppsAndKeys.Tokens.apiKeyRestriction.enter.ip"}),fullWidth:!0,id:"ip-address-txt"})),a.createElement(w.Ay,{item:!0,md:2,xs:2},a.createElement("span",null,a.createElement(_.A,{className:Q.Fab,size:"small",color:"primary","aria-label":"add",onClick:()=>{null!==o&&""!==o&&(N.A.ipAddress.validate(o).error?i(!0):(i(!1),p.push(o),d(p),c("")))},id:"ip-address-add-btn"},a.createElement(F.A,null))))),a.createElement(w.Ay,{container:!0,direction:"row",spacing:0,justifyContent:"left",alignItems:"left",md:10,xs:10},p.length>0&&a.createElement(V.A,null,p.map(((e,t)=>a.createElement(H.Ay,null,a.createElement(Y.A,{primary:e}),a.createElement(G.A,null,a.createElement(z.A,{title:r.formatMessage({defaultMessage:"Delete task",id:"Shared.ApiKeyRestriction.key.restrictions.delete.task.tooltip"}),placement:"top"},a.createElement(K.A,{edge:"end","aria-label":"delete",onClick:()=>{return t=e,p.splice(p.indexOf(t),1),void d(p);var t},size:"large"},a.createElement(j.default,null)))))))))),"referer"===g&&a.createElement(n.A,{component:"div",id:"refererPanel"},a.createElement(w.Ay,{container:!0,direction:"row",spacing:0,justifyContent:"left",alignItems:"left"},a.createElement(w.Ay,{item:!0,md:10,xs:10},a.createElement(I.A,{label:r.formatMessage({defaultMessage:"Referer",id:"Shared.AppsAndKeys.Tokens.apiKeyRestriction.referer.label"}),value:A,onChange:e=>{f(e.target.value.trim()),""===e.target.value.trim()&&l(!1)},className:Q.inputText,helperText:s?r.formatMessage({defaultMessage:"Invalid Http Referer",id:"Shared.AppsAndKeys.Tokens.apiKeyRestriction.referer.validity.error"}):"",error:s,size:"small",margin:"dense",variant:"outlined",placeholder:r.formatMessage({defaultMessage:"Enter Http Referer",id:"Shared.AppsAndKeys.Tokens.apiKeyRestriction.enter.referer"}),fullWidth:!0,id:"referer-txt"})),a.createElement(w.Ay,{item:!0,md:2,xs:2},a.createElement("span",null,a.createElement(_.A,{size:"small",className:Q.Fab,color:"primary","aria-label":"add",onClick:()=>{null!==A&&""!==A?(l(!1),b.push(A.trim()),y(b),f("")):l(!0)},id:"referer-add-btn"},a.createElement(F.A,null))))),a.createElement(w.Ay,{container:!0,direction:"row",spacing:0,justifyContent:"left",alignItems:"left",md:10,xs:10},b.length>0&&a.createElement(V.A,null,b.map(((e,t)=>a.createElement(H.Ay,null,a.createElement(Y.A,{primary:e}),a.createElement(G.A,null,a.createElement(z.A,{title:r.formatMessage({defaultMessage:"Delete task",id:"Shared.ApiKeyRestriction.key.restrictions.delete.task.tooltip"}),placement:"top"},a.createElement(K.A,{edge:"end","aria-label":"delete",onClick:()=>{return t=e,b.splice(b.indexOf(t),1),void y(b);var t},size:"large"},a.createElement(j.default,null))))))))))))};te.contextTypes={intl:r().shape({}).isRequired};const ie=(0,g.Ay)(te);var ae=i(14977),ne=i(37636),se=i(73357);function le(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const re="ApiKeyManager",oe={root:`${re}-root`,dialog:`${re}-dialog`,button:`${re}-button`,tokenSection:`${re}-tokenSection`,margin:`${re}-margin`,keyConfigWrapper:`${re}-keyConfigWrapper`,generateWrapper:`${re}-generateWrapper`,paper:`${re}-paper`,dialogTitle:`${re}-dialogTitle`,dialogContent:`${re}-dialogContent`,formGroup:`${re}-formGroup`,gridWrapper:`${re}-gridWrapper`,keyTitle:`${re}-keyTitle`,cardBody:`${re}-cardBody`,generateKey:`${re}-generateKey`},ce=(0,s.Ay)(w.Ay)((e=>{let{theme:t}=e;return{[`& .${oe.root}`]:{padding:t.spacing(3),"& span, & h5, & label, & input":{color:t.palette.getContrastText(t.palette.background.paper)}},[`& .${oe.dialog}`]:{"& span, & h2, & label":{color:t.palette.getContrastText(t.palette.background.paper)}},[`& .${oe.button}`]:{"& span":{color:t.palette.getContrastText(t.palette.primary.main)}},[`& .${oe.tokenSection}`]:{marginTop:t.spacing(2),marginBottom:t.spacing(2)},[`& .${oe.margin}`]:{marginRight:t.spacing(2)},[`& .${oe.keyConfigWrapper}`]:{flexDirection:"column",marginBottom:0},[`& .${oe.generateWrapper}`]:{padding:"10px","margin-inline-end":"auto"},[`& .${oe.paper}`]:{display:"flex",marginTop:t.spacing(2),marginBottom:t.spacing(2),marginLeft:t.spacing(10)},[`& .${oe.dialogTitle}`]:{padding:"24px 24px 0px"},[`& .${oe.dialogContent}`]:{padding:"0 24px 0px"},[`& .${oe.formGroup}`]:{padding:"20px"},[`& .${oe.gridWrapper}`]:{"align-self":"center"},[`& .${oe.keyTitle}`]:{textTransform:"capitalize"},[`& .${oe.cardBody}`]:{padding:t.spacing(1),lineHeight:2},[`& .${oe.generateKey}`]:{"& span":{color:t.palette.getContrastText(t.palette.primary.main)}}}}));class pe extends a.Component{constructor(e){super(e),le(this,"updateIpList",(e=>{this.setState((()=>({ipList:e})))})),le(this,"updateNewIp",(e=>{this.setState((()=>({newIP:e})))})),le(this,"updateRefererList",(e=>{this.setState((()=>({refererList:e})))})),le(this,"updateNewReferer",(e=>{this.setState((()=>({newReferer:e})))})),le(this,"updateRestrictSchema",(e=>{this.setState((()=>({restrictSchema:e})))})),le(this,"handleClose",(()=>{this.setState((()=>({open:!1,accessTokenRequest:{timeout:-1}})))})),le(this,"handleClickOpen",(()=>{this.setState((()=>({open:!0,showToken:!1})))})),le(this,"updateAccessTokenRequest",(e=>{this.setState((()=>({accessTokenRequest:e})))})),le(this,"generateKeys",(()=>{const{selectedApp:e,keyType:t}=this.props;this.setState({isGenerating:!0});const i=new h.A,a={permittedIP:this.state.ipList.join(","),permittedReferer:this.state.refererList.join(",")};i.generateApiKey(e.appId,t,this.state.accessTokenRequest.timeout,a).then((e=>{console.log("Non empty response received");const t={accessToken:e.body.apikey,validityTime:e.body.validityTime,isOauth:!1};this.setState((()=>({apikey:t,open:!0,showToken:!0,ipList:[],refererList:[]}))),this.setState({isGenerating:!1})})).catch((e=>{const{status:t}=e;404===t&&this.setState({notFound:!0,ipList:[],refererList:[]}),this.setState({isGenerating:!1})}))})),this.state={apikey:null,open:!1,showToken:!1,accessTokenRequest:{timeout:-1},ipList:[],newIP:null,restrictSchema:"none",refererList:[],newReferer:null,isGenerating:!1}}render(){const{showToken:e,accessTokenRequest:t,open:i,apikey:n,newIP:s,ipList:l,newReferer:r,refererList:o,restrictSchema:c,isGenerating:p}=this.state;return a.createElement(ce,{container:!0,direction:"row",spacing:0,justifyContent:"left",alignItems:"left"},a.createElement(w.Ay,{item:!0,md:5,xs:12},a.createElement(ie,{updateNewIp:this.updateNewIp,newIP:s,updateIpList:this.updateIpList,ipList:l,restrictSchema:c,updateRestrictSchema:this.updateRestrictSchema,refererList:o,newReferer:r,updateNewReferer:this.updateNewReferer,updateRefererList:this.updateRefererList}),a.createElement(D.A,{row:!0,className:oe.formGroup},a.createElement(v.A,{variant:"contained",color:"primary",onClick:this.handleClickOpen,className:oe.generateKey,id:"generate-key-btn"},this.props.intl.formatMessage({id:"Shared.AppsAndKeys.ApiKeyManager.generate.key.btn",defaultMessage:"Generate Key"})),a.createElement(u.A,{component:"div",variant:"body2",className:oe.formLabel},a.createElement(m.A,{id:"Shared.AppsAndKeys.ApiKeyManager.generate.key.help",defaultMessage:"Use the Generate Key button to generate a self-contained JWT token."}))),a.createElement(S.A,{open:i,onClose:this.handleClose,"aria-labelledby":"form-dialog-title",className:oe.dialog},a.createElement(k.A,{id:"responsive-dialog-title",className:oe.dialogTitle},this.props.intl.formatMessage({id:"Shared.AppsAndKeys.ApiKeyManager.generate.api.key.btn",defaultMessage:"Generate API Key"})),a.createElement(T.A,{className:oe.dialogContent},a.createElement(x.A,null,!e&&a.createElement(W,{updateAccessTokenRequest:this.updateAccessTokenRequest,accessTokenRequest:t}),e&&a.createElement(P.A,{token:n}))),a.createElement(M.A,null,!e&&a.createElement(v.A,{onClick:this.generateKeys,disabled:!t.timeout||p,color:"primary",variant:"contained",className:oe.button,id:"generate-api-keys-btn"},a.createElement(m.A,{id:"Shared.AppsAndKeys.ViewKeys.consumer.generate.btn",defaultMessage:"Generate"}),p&&a.createElement(se.A,{size:24})),a.createElement(v.A,{onClick:this.handleClose,color:"grey",autoFocus:!0,id:"generate-api-keys-close-btn"},a.createElement(m.A,{id:"Shared.AppsAndKeys.ViewKeys.consumer.close.btn",defaultMessage:"Close"}))))),"ip"===c&&a.createElement(w.Ay,{item:!0,md:5,xs:12},a.createElement(ae.A,null,a.createElement(ne.A,null,a.createElement(u.A,{variant:"h5",component:"h2"},a.createElement(m.A,{id:"Shared.AppsAndKeys.ViewKeys.apiKeyRestriction.ip.example.heading",defaultMessage:"Examples of IP Addresses allowed"})),a.createElement(u.A,{variant:"body1",component:"p",className:oe.cardBody},a.createElement(m.A,{id:"Shared.AppsAndKeys.ViewKeys.apiKeyRestriction.ip.example.content",defaultMessage:"Specify one IPv4 or IPv6 or a subnet using CIDR notation{linebreak}Examples: {ip1}, {ip2}, {ip3} or {ip4}",values:{linebreak:a.createElement("br",null),ip1:a.createElement("b",null,"192.168.1.2"),ip2:a.createElement("b",null,"152.12.0.0/13"),ip3:a.createElement("b",null,"2002:eb8::2"),ip4:a.createElement("b",null,"1001:ab8::/44")}}))))),"referer"===c&&a.createElement(w.Ay,{item:!0,md:5,xs:12},a.createElement(ae.A,null,a.createElement(ne.A,null,a.createElement(u.A,{variant:"h5",component:"h2"},a.createElement(m.A,{id:"Shared.AppsAndKeys.ViewKeys.apiKeyRestriction.referer.example.heading",defaultMessage:"Examples of URLs allowed to restrict websites"})),a.createElement(u.A,{variant:"body1",component:"p",className:oe.cardBody},a.createElement(m.A,{id:"Shared.AppsAndKeys.ViewKeys.apiKeyRestriction.ip.example.content.message",defaultMessage:"A specific URL with an exact path: {url1}{linebreak}Any URL in a single subdomain, using a wildcard asterisk (*): {url2}{linebreak}Any subdomain or path URLs in a single domain, using wildcard asterisks (*): {url3}",values:{linebreak:a.createElement("br",null),url1:a.createElement("b",null,"www.example.com/path"),url2:a.createElement("b",null,"sub.example.com/*"),url3:a.createElement("b",null,"*.example.com/*")}}))))))}}pe.propTypes={classes:r().shape({}).isRequired,selectedApp:r().shape({tokenType:r().string.isRequired}).isRequired,keyType:r().string.isRequired,intl:r().shape({formatMessage:r().func}).isRequired};const de=(0,g.Ay)(pe);var ue=i(46942),me=i.n(ue),ge=i(34339),he=i(61523),Ae=i(36575),fe=i(70691),be=i(53723),ye=i(23049),Ee=i(92728),ve=i(7824),Se=i(53420),Me=i(64745),Te=i(85877),xe=i(84712),ke=i(32413),De=i(62861),we=i(31076),Pe=i(17681),Ie=i(23165),Re=i(44675),Ce=i(67783);function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},$e.apply(null,arguments)}const Ne="SubscriptionPolicySelectLegacy",Le={root:`${Ne}-root`,buttonGap:`${Ne}-buttonGap`,select:`${Ne}-select`},Oe=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{[`&.${Le.root}`]:{display:"flex"},[`& .${Le.buttonGap}`]:{background:t.palette.grey[300],marginLeft:20,"& span span":{color:t.palette.getContrastText(t.palette.primary.main)}},[`& .${Le.select}`]:{width:100}}}));class Be extends a.Component{constructor(e){super(e),this.state={selectedPolicy:null}}componentDidMount(){const{policies:e}=this.props;this.setState({selectedPolicy:e[0]})}render(){const{policies:e,apiId:t,handleSubscribe:i,applicationId:n}=this.props,{selectedPolicy:s}=this.state;return e&&a.createElement(Oe,{className:Le.root},a.createElement(Ie.A,{id:"policy-select",disableClearable:!0,options:e,value:s,onChange:(e,t)=>{this.setState({selectedPolicy:t})},style:{width:200},renderInput:e=>a.createElement(I.A,$e({size:"small",variant:"standard"},e)),renderOption:(e,t)=>a.createElement(Pe.A,$e({},e,{value:t,key:t,id:"policy-select-"+t}),t)}),a.createElement(Ce.M9,{resourcePath:Ce.Hc.SUBSCRIPTIONS,resourceMethod:Ce.DT.POST},a.createElement(v.A,{variant:"contained",size:"small",color:"grey",className:Le.buttonGap,onClick:()=>{i(n,t,s)},id:"policy-subscribe-btn-"+t},a.createElement(m.A,{defaultMessage:"Subscribe",id:"Apis.Listing.SubscriptionPolicySelect.subscribe"}))))}}Be.propTypes={classes:r().shape({}).isRequired,policies:r().shape({}).isRequired,apiId:r().string.isRequired,handleSubscribe:r().func.isRequired,applicationId:r().string.isRequired};const qe=function(e){const{key:t,policies:i,apiId:n,handleSubscribe:s,applicationId:l}=e,r=(0,Re.A)();return a.createElement(Be,{key:t,policies:i,apiId:n,handleSubscribe:s,applicationId:l,theme:r})};function Ue(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const We="APICardView",Ke=`${We}-root`,je=`${We}-buttonGap`,ze=(0,s.Ay)("div")((()=>({[`& .${Ke}`]:{display:"flex"},[`& .${je}`]:{marginRight:10}})));class _e extends a.Component{constructor(e){super(e),Ue(this,"getData",(()=>{const{intl:e}=this.props;this.xhrRequest().then((e=>{const{body:t}=e,{list:i,pagination:a}=t,{total:n}=a;this.count=n,this.setState({data:this.updateUnsubscribedAPIsList(i)})})).catch((t=>{const{response:i}=t,{setTenantDomain:a}=this.props;i&&901300===i.body.code?(a("INVALID"),xe.A.error(e.formatMessage({defaultMessage:"Invalid tenant domain",id:"Apis.Listing.ApiTableView.invalid.tenant.domain"}))):xe.A.error(e.formatMessage({defaultMessage:"Error While Loading APIs",id:"Apis.Listing.ApiTableView.error.loading"}))})).finally((()=>{this.setState({loading:!1})}))})),Ue(this,"changePage",(e=>{const{intl:t}=this.props;this.page=e,this.setState({loading:!0}),this.xhrRequest().then((e=>{const{body:t}=e,{list:i}=t;this.setState({data:this.updateUnsubscribedAPIsList(i)})})).catch((()=>{xe.A.error(t.formatMessage({defaultMessage:"Error While Loading APIs",id:"Apis.Listing.ApiTableView.error.loading"}))})).finally((()=>{this.setState({loading:!1})}))})),Ue(this,"xhrRequest",(()=>{const{searchText:e}=this.props,{page:t,rowsPerPage:i}=this,a=new h.A;return e&&""!==e?a.getAllAPIs({query:`${e} status:published`,limit:this.rowsPerPage,offset:t*i}):a.getAllAPIs({query:"status:published",limit:this.rowsPerPage,offset:t*i})})),this.state={data:null,loading:!0},this.page=0,this.count=100,this.rowsPerPage=10,this.pageType=null}componentDidMount(){this.getData()}componentDidUpdate(e){const{subscriptions:t,searchText:i}=this.props;t.length!==e.subscriptions.length?this.getData():i!==e.searchText&&(this.page=0,this.getData())}getIdsOfSubscribedEntities(){const{subscriptions:e}=this.props;return e.map((e=>e.apiId)).filter(Boolean)}updateUnsubscribedAPIsList(e){const t=this.getIdsOfSubscribedEntities(),i=e.filter((e=>!(1===e.throttlingPolicies.length&&e.throttlingPolicies[0].includes(De.A.DEFAULT_SUBSCRIPTIONLESS_PLAN))));for(let e=0;e<i.length;e++){const a=i[e].throttlingPolicies.filter((e=>!e.includes(De.A.DEFAULT_SUBSCRIPTIONLESS_PLAN)));i[e].throttlingPolicies=a,(t.includes(i[e].id)||i[e].advertiseInfo.advertised||!i[e].isSubscriptionAvailable)&&(i[e].throttlingPolicies=null)}return i}render(){const{apisNotFound:e}=this.props,{loading:t,data:i}=this.state,{page:n,count:s,rowsPerPage:l}=this;if(e)return a.createElement(b.A,null);const{handleSubscribe:r,applicationId:o,intl:c}=this.props,p=[{name:"id",label:c.formatMessage({id:"Apis.Listing.APIList.id",defaultMessage:"Id"}),options:{display:"excluded"}},{name:"isSubscriptionAvailable",label:c.formatMessage({id:"Apis.Listing.APIList.isSubscriptionAvailable",defaultMessage:"Is Subscription Available"}),options:{display:"excluded"}},{name:"name",label:c.formatMessage({id:"Apis.Listing.APIList.name",defaultMessage:"Name"})},{name:"version",label:c.formatMessage({id:"Apis.Listing.APIList.version",defaultMessage:"Version"})},{name:"throttlingPolicies",label:c.formatMessage({id:"Apis.Listing.APIList.subscription.status",defaultMessage:"Subscription Status"}),options:{customBodyRender:(e,t)=>{if(t.rowData){const i=t.rowData[0],n=e;return t.rowData[1]?n?a.createElement(qe,{key:i,policies:n,apiId:i,handleSubscribe:(e,t,i)=>r(e,t,i),applicationId:o}):c.formatMessage({id:"Apis.Listing.APICardView.already.subscribed",defaultMessage:"Subscribed"}):c.formatMessage({id:"Apis.Listing.APICardView.not.allowed",defaultMessage:"Not Allowed"})}return a.createElement("span",null)}}}],d={search:!1,title:!1,filter:!1,print:!1,download:!1,viewColumns:!1,customToolbar:!1,responsive:"stacked",serverSide:!0,count:s,page:n,onTableChange:(e,t)=>{"changePage"===e&&this.changePage(t.page)},selectableRows:"none",rowsPerPage:l,onChangeRowsPerPage:e=>{const{page:t,count:i}=this;t*e>i&&(this.page=0),this.rowsPerPage=e,this.getData()},textLabels:{pagination:{rowsPerPage:c.formatMessage({id:"Apis.Listing.APICardView.rows.per.page",defaultMessage:"Rows per page"})}}};return t?a.createElement(f.A,null):i&&0===i.length||!i?a.createElement(we.A,null):a.createElement(ze,{id:"subscribe-to-api-table"},a.createElement(ke.Ay,{title:"",data:i,columns:p,options:d}))}}_e.propTypes={intl:r().shape({formatMessage:r().func}).isRequired};const Fe=(0,g.Ay)(_e);var Ve=i(75623),He=i(61914),Ge=i(48875),Ye=i(27738),Je=i(9165),Xe=i(85996);const Ze="Invoice-dialogWrapper",Qe=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{[`& .${Ze}`]:{"& span,& p , & h5, & label, & td, & li":{color:t.palette.getContrastText(t.palette.background.paper)},"& div, & input, & p.MuiFormHelperText-root":{color:t.palette.getContrastText(t.palette.background.paper)}}}})),et=["Name","Value"],tt={filterType:"checkbox",sort:!1,search:!1,viewColumns:!1,filter:!1,selectableRowsHeader:!1,selectableRows:"none",pagination:!1,download:!1};function it(e){const{subscriptionId:t,tiers:i}=e,[n,s]=(0,a.useState)(!1),[l,r]=(0,a.useState)(!1),[o,c]=(0,a.useState)(null),p=()=>{r(!1)};return a.createElement(Qe,null,a.createElement(v.A,{color:"grey",onClick:()=>{s(!0),c(null),(new Ve.A).getMonetizationInvoice(t).then((e=>{if(e&&e.obj){const t=[],{obj:{properties:i}}=e;Object.keys(i).forEach((e=>{const a=[];a.push(e),a.push(i[e]),t.push(a)})),c(t)}})).catch((e=>{console.error(e),r(!0)}))},startIcon:a.createElement(Ee.A,null,"receipt"),disabled:0===i.length},a.createElement(m.A,{id:"Applications.Details.Invoice.view.btn",defaultMessage:"View Invoice"})),o?a.createElement(S.A,{open:n,onClose:()=>{s(!1)},fullWidth:"true",className:Ze},o&&a.createElement(ke.Ay,{title:"Upcoming Invoice",data:o,columns:et,options:tt})):a.createElement(S.A,{open:l,onClose:p,fullWidth:"true",className:Ze},a.createElement(k.A,null,a.createElement(m.A,{id:"Applications.Details.Invoice.no.data.available",defaultMessage:"No Data Available"})),a.createElement(T.A,null,a.createElement(x.A,{id:"invoice-dialog-description"},a.createElement(m.A,{id:"Applications.Details.Invoice.pending.invoice.data",defaultMessage:"Pending invoice data not found for this subscription."}))),a.createElement(M.A,null,a.createElement(v.A,{onClick:p,color:"primary"},a.createElement(m.A,{id:"Applications.Details.Invoice.close",defaultMessage:"Close"})))))}it.defaultProps={tiers:[]},it.propTypes={subscriptionId:r().string.isRequired,tiers:r().arrayOf(r().string)};const at=it;function nt(){return nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},nt.apply(null,arguments)}class st extends a.Component{constructor(e){super(e),this.state={openMenu:!1,openMenuEdit:!1,isMonetizedAPI:!1,isDynamicUsagePolicy:!1,tiers:[],selectedTier:""},this.handleRequestClose=this.handleRequestClose.bind(this),this.handleRequestOpen=this.handleRequestOpen.bind(this),this.handleRequestDelete=this.handleRequestDelete.bind(this),this.checkIfDynamicUsagePolicy=this.checkIfDynamicUsagePolicy.bind(this),this.checkIfMonetizedAPI=this.checkIfMonetizedAPI.bind(this),this.populateSubscriptionTiers=this.populateSubscriptionTiers.bind(this),this.handleSubscriptionTierUpdate=this.handleSubscriptionTierUpdate.bind(this),this.handleRequestCloseEditMenu=this.handleRequestCloseEditMenu.bind(this),this.handleRequestOpenEditMenu=this.handleRequestOpenEditMenu.bind(this),this.setSelectedTier=this.setSelectedTier.bind(this)}componentDidMount(){this.checkIfMonetizedAPI(this.props.subscription.apiId),this.checkIfDynamicUsagePolicy(this.props.subscription.subscriptionId),this.populateSubscriptionTiers(this.props.subscription.apiId)}setSelectedTier(e){this.setState({selectedTier:e})}handleRequestDelete(e){const{handleSubscriptionDelete:t}=this.props;this.setState({openMenu:!1}),t&&t(e)}handleRequestCloseEditMenu(){this.setState({openMenuEdit:!1})}handleRequestOpenEditMenu(){this.setState({openMenuEdit:!0})}handleRequestOpen(){this.setState({openMenu:!0})}handleRequestClose(){this.setState({openMenu:!1})}handleSubscriptionTierUpdate(e,t,i,a,n){const{handleSubscriptionUpdate:s}=this.props;this.setState({openMenuEdit:!1}),s&&s(e,t,n,a,i)}populateSubscriptionTiers(e){(new h.A).getAPIById(e).then((e=>{if(e&&e.data){const t=JSON.parse(e.data).tiers,i=[];for(let e=0;e<t.length;e++){const{tierName:a}=t[e];i.push({value:a,label:a})}this.setState({tiers:i})}}))}checkIfMonetizedAPI(e){(new h.A).getAPIById(e).then((e=>{if(e&&e.data){const t=JSON.parse(e.data);this.setState({isMonetizedAPI:t.monetization.enabled})}}))}checkIfDynamicUsagePolicy(e){(new Ve.A).getSubscription(e).then((e=>{if(e&&e.body){const t=JSON.parse(e.data);t.throttlingPolicy&&(new h.A).getTierByName(t.throttlingPolicy,"subscription").then((e=>{const t=JSON.parse(e.data);t.monetizationAttributes.billingType&&"DYNAMICRATE"===t.monetizationAttributes.billingType&&this.setState({isDynamicUsagePolicy:!0})}))}}))}render(){const{subscription:{apiInfo:e,status:t,throttlingPolicy:i,subscriptionId:s,apiId:l,requestedThrottlingPolicy:r}}=this.props,{openMenu:c,isMonetizedAPI:p,isDynamicUsagePolicy:d,openMenuEdit:u,selectedTier:g,tiers:h}=this.state,A=h&&1===h.length&&h[0].value.includes(De.A.DEFAULT_SUBSCRIPTIONLESS_PLAN),f=a.createElement(o.N_,{to:0===h.length?"":"/apis/"+l,style:{cursor:0===h.length?"default":""},external:!0},e.name+" - "+e.version+" ",a.createElement(Xe.Icon,{path:Je.gs2,size:"12px"}));return!A&&a.createElement(ye.A,{hover:!0},a.createElement(fe.A,null,f),a.createElement(fe.A,null,e.lifeCycleStatus),i.includes(De.A.DEFAULT_SUBSCRIPTIONLESS_PLAN)?a.createElement(fe.A,null,i," ",a.createElement(z.A,{placement:"bottom",interactive:!0,"aria-label":"helper text for default subscription policy",title:a.createElement(a.Fragment,null,a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.policy.default.tooltip",defaultMessage:"This is the default subscription policy used when subscription validation was disabled."})),sx:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",maxWidth:220,fontSize:"12px",border:"1px solid #dadde9"}},a.createElement(n.A,{component:"span",sx:{display:"inline-flex",verticalAlign:"middle",fontSize:"16px"}},a.createElement(Ye.A,{sx:{fontSize:"inherit"}})))):a.createElement(fe.A,null,i),a.createElement(fe.A,null,t),a.createElement(fe.A,null,a.createElement(v.A,{id:"edit-api-subscription-"+l,color:"grey",onClick:this.handleRequestOpenEditMenu,startIcon:a.createElement(Ee.A,null,"edit"),disabled:0===h.length},a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.edit.text",defaultMessage:"Edit"})),a.createElement(S.A,{open:u,transition:Ge.A},a.createElement(k.A,null,a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update.subscription",defaultMessage:"Update Subscription"})),a.createElement(T.A,null,a.createElement(x.A,null,a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update.business.plan",defaultMessage:"Current Business Plan : "}),i,a.createElement("div",null,"BLOCKED"===t?a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update.throttling.policy.blocked",defaultMessage:"Subscription is in BLOCKED state. You need to unblock the subscription in order to edit the tier"}):"ON_HOLD"===t?a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update.throttling.policy.onHold",defaultMessage:"Subscription is currently ON_HOLD state. You need to get approval to the subscription before editing the tier"}):"REJECTED"===t?a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update.throttling.policy.rejected",defaultMessage:"Subscription is currently REJECTED state. You need to get approval to the subscription before editing the tier"}):"TIER_UPDATE_PENDING"===t?a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update.throttling.policy.tierUpdatePending",defaultMessage:"Subscription is currently TIER_UPDATE_PENDING state. You need to get approval to the existing subscription edit request before editing the tier"}):a.createElement("div",null,a.createElement(Ie.A,{id:"application-policy",disableClearable:!0,options:h,getOptionLabel:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e},getOptionSelected:(e,t)=>e.value===t,value:g,onChange:(e,t)=>this.setSelectedTier(t.value),renderInput:e=>a.createElement(I.A,nt({id:"outlined-select-currency",name:"throttlingPolicy",required:!0},e,{label:a.createElement(m.A,{defaultMessage:"Business Plan",id:"Applications.Details.SubscriptionTableData.update.business.plan.name"}),helperText:a.createElement(m.A,{defaultMessage:"Assign a new Business plan to the existing subscription",id:"Applications.Details.SubscriptionTableData.update.throttling.policy.helper"}),margin:"normal",variant:"outlined"}))}),"TIER_UPDATE_PENDING"===t&&a.createElement("div",null,a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update.throttling.policy.tier.update",defaultMessage:"Pending Tier Update : "}),r))))),a.createElement(M.A,null,a.createElement(v.A,{dense:!0,color:"grey",onClick:this.handleRequestCloseEditMenu},a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.cancel",defaultMessage:"Cancel"})),a.createElement(v.A,{variant:"contained",disabled:"BLOCKED"===t||"ON_HOLD"===t||"REJECTED"===t||"TIER_UPDATE_PENDING"===t,dense:!0,color:"primary",onClick:()=>this.handleSubscriptionTierUpdate(l,s,g,t,i),"data-testid":"subscription-tier-update-button"},a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.update",defaultMessage:"Update"})))),a.createElement(Ce.M9,{resourcePath:Ce.Hc.SINGLE_SUBSCRIPTION,resourceMethod:Ce.DT.DELETE},a.createElement(v.A,{id:"delete-api-subscription-"+l,color:"grey",onClick:this.handleRequestOpen,startIcon:a.createElement(Ee.A,null,"delete"),disabled:0===h.length||"DELETE_PENDING"===t},a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.delete.text",defaultMessage:"Delete"}))),a.createElement(S.A,{open:c,transition:Ge.A},a.createElement(k.A,null,a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.delete.subscription.confirmation.dialog.title",defaultMessage:"Confirm"})),a.createElement(T.A,null,a.createElement(x.A,null,a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.delete.subscription.confirmation",defaultMessage:"Are you sure you want to delete the Subscription?"}))),a.createElement(M.A,null,a.createElement(v.A,{dense:!0,color:"grey",onClick:this.handleRequestClose},a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.cancel",defaultMessage:"Cancel"})),a.createElement(v.A,{id:"delete-api-subscription-confirm-btn",dense:!0,variant:"contained",color:"primary",onClick:()=>this.handleRequestDelete(s)},a.createElement(m.A,{id:"Applications.Details.SubscriptionTableData.delete",defaultMessage:"Delete"})))),p&&a.createElement(at,{tiers:h,subscriptionId:s,isDynamicUsagePolicy:d})))}}st.propTypes={subscription:r().shape({apiInfo:r().shape({name:r().string.isRequired,version:r().string.isRequired,lifeCycleStatus:r().string.isRequired}).isRequired,throttlingPolicy:r().string.isRequired,subscriptionId:r().string.isRequired,apiId:r().string.isRequired,status:r().string.isRequired,requestedThrottlingPolicy:r().string.isRequired}).isRequired,handleSubscriptionDelete:r().func.isRequired,handleSubscriptionUpdate:r().func.isRequired};const lt=st,rt="Subscriptions",ot={searchRoot:`${rt}-searchRoot`,searchBar:`${rt}-searchBar`,input:`${rt}-input`,iconButton:`${rt}-iconButton`,divider:`${rt}-divider`,root:`${rt}-root`,subscribePop:`${rt}-subscribePop`,firstCell:`${rt}-firstCell`,cardTitle:`${rt}-cardTitle`,cardContent:`${rt}-cardContent`,titleWrapper:`${rt}-titleWrapper`,dialogHeader:`${rt}-dialogHeader`,dialogTitle:`${rt}-dialogTitle`,genericMessageWrapper:`${rt}-genericMessageWrapper`,searchResults:`${rt}-searchResults`,clearSearchIcon:`${rt}-clearSearchIcon`,subsTable:`${rt}-subsTable`,closeButton:`${rt}-closeButton`},ct=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{[`& .${ot.root}`]:{padding:t.spacing(3),"& h5":{color:t.palette.getContrastText(t.palette.background.default)}},[`& .${ot.firstCell}`]:{paddingLeft:0},[`& .${ot.cardContent}`]:{"& table tr td":{paddingLeft:t.spacing(1)},"& table tr:nth-child(even)":{backgroundColor:t.custom.listView.tableBodyEvenBackgrund,"& td, & a":{color:t.palette.getContrastText(t.custom.listView.tableBodyEvenBackgrund)}},"& table tr:nth-child(odd)":{backgroundColor:t.custom.listView.tableBodyOddBackgrund,"& td, & a":{color:t.palette.getContrastText(t.custom.listView.tableBodyOddBackgrund)}},"& table th":{backgroundColor:t.custom.listView.tableHeadBackground,color:t.palette.getContrastText(t.custom.listView.tableHeadBackground),paddingLeft:t.spacing(1)}},[`& .${ot.titleWrapper}`]:{display:"flex",alignItems:"center",paddingBottom:t.spacing(2),"& h5":{marginRight:t.spacing(1)}},[`& .${ot.genericMessageWrapper}`]:{margin:t.spacing(2)},[`& .${ot.subsTable}`]:{"& td":{padding:"4px 8px"}}}})),pt=(0,s.Ay)(S.A)((e=>{let{theme:t}=e;return{[`& .${ot.subscribePop}`]:{"& span, & h5, & label, & input, & td, & li":{color:t.palette.getContrastText(t.palette.background.paper)}},[`& .${ot.dialogHeader}`]:{display:"flex",justifyContent:"space-between"},[`& .${ot.dialogTitle}`]:{marginTop:t.spacing(1),padding:t.spacing(2)},[`& .${ot.searchRoot}`]:{marginLeft:"auto",width:"50%",marginTop:t.spacing(2)},[`& .${ot.searchBar}`]:{padding:"2px 4px",display:"flex",alignItems:"center",flex:1,marginLeft:t.spacing(2),marginRight:t.spacing(1)},[`& .${ot.clearSearchIcon}`]:{cursor:"pointer"},[`& .${ot.input}`]:{marginLeft:t.spacing(1),flex:1},[`& .${ot.iconButton}`]:{padding:10},[`& .${ot.searchResults}`]:{height:30,display:"flex",paddingTop:t.spacing(1),paddingRight:0,paddingBottom:0,paddingLeft:t.spacing(3)},[`& .${ot.closeButton}`]:{height:"100%",marginTop:t.spacing(2),marginRight:t.spacing(1)}}}));class dt extends a.Component{constructor(e){super(e),this.state={subscriptions:null,apisNotFound:!1,subscriptionsNotFound:!1,isAuthorize:!0,openDialog:!1,searchText:"",pseudoSubscriptions:!1},this.checkSubValidationDisabled=this.checkSubValidationDisabled.bind(this),this.handleSubscriptionDelete=this.handleSubscriptionDelete.bind(this),this.handleSubscriptionUpdate=this.handleSubscriptionUpdate.bind(this),this.updateSubscriptions=this.updateSubscriptions.bind(this),this.handleSubscribe=this.handleSubscribe.bind(this),this.handleOpenDialog=this.handleOpenDialog.bind(this),this.handleSearchTextChange=this.handleSearchTextChange.bind(this),this.handleSearchTextTmpChange=this.handleSearchTextTmpChange.bind(this),this.handleClearSearch=this.handleClearSearch.bind(this),this.handleEnterPress=this.handleEnterPress.bind(this),this.searchTextTmp=""}componentDidMount(){const{applicationId:e}=this.props.application;this.updateSubscriptions(e)}handleOpenDialog(){this.setState((e=>({openDialog:!e.openDialog,searchText:""})))}checkSubValidationDisabled(e){null!==e&&e.length>0&&e.filter((e=>e.apiInfo.throttlingPolicies&&1===e.apiInfo.throttlingPolicies.length&&e.apiInfo.throttlingPolicies[0].includes(De.A.DEFAULT_SUBSCRIPTIONLESS_PLAN))).length===e.length?this.setState({pseudoSubscriptions:!0}):this.setState({pseudoSubscriptions:!1})}updateSubscriptions(e){const t=new Ve.A,i=A.app.subscriptionLimit||1e3;t.getSubscriptions(null,e,i).then((e=>{this.setState({subscriptions:e.body.list}),this.checkSubValidationDisabled(e.body.list)})).catch((e=>{const{status:t}=e;404===t?this.setState({subscriptionsNotFound:!0}):401===t&&this.setState({isAuthorize:!1})}))}handleSubscriptionDelete(e){const{intl:t}=this.props;(new Ve.A).deleteSubscription(e).then((i=>{if(200===i.status&&xe.A.info(t.formatMessage({defaultMessage:"Subscription deleted successfully!",id:"Applications.Details.Subscriptions.delete.success"})),201===i.status){console.log(i),xe.A.info(t.formatMessage({defaultMessage:"Subscription Deletion Request Created!",id:"Applications.Details.Subscriptions.request.created"}));const{applicationId:e}=this.props.application;return void this.updateSubscriptions(e)}if(200!==i.status&&201!==i.status)return console.log(i),void xe.A.info(t.formatMessage({defaultMessage:"Something went wrong while deleting the Subscription!",id:"Applications.Details.Subscriptions.something.went.wrong"}));const{subscriptions:a}=this.state;for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)&&a[t].subscriptionId===e){a.splice(t,1);break}this.setState({subscriptions:a}),this.checkSubValidationDisabled(a),this.props.getApplication()})).catch((e=>{const{status:i}=e;401===i&&this.setState({isAuthorize:!1}),xe.A.error(t.formatMessage({defaultMessage:"Error occurred when deleting subscription",id:"Applications.Details.Subscriptions.error.while.deleting"}))}))}handleSubscriptionUpdate(e,t,i,a,n){const{intl:s}=this.props,{applicationId:l}=this.props.application;(new Ve.A).updateSubscription(l,e,t,i,a,n).then((e=>{if(200!==e.status&&201!==e.status)return console.log(e),void xe.A.info(s.formatMessage({defaultMessage:"Something went wrong while updating the Subscription!",id:"Applications.Details.Subscriptions.wrong.with.subscription"}));"TIER_UPDATE_PENDING"===e.body.status?xe.A.info(s.formatMessage({defaultMessage:"Your subscription update request has been submitted and is now awaiting approval.",id:"subscription.tierPending"})):xe.A.info(s.formatMessage({defaultMessage:"Business Plan updated successfully!",id:"Applications.Details.Subscriptions.business.plan.updated"})),this.updateSubscriptions(l),this.props.getApplication()})).catch((e=>{const{status:t}=e;401===t&&this.setState({isAuthorize:!1}),xe.A.error(s.formatMessage({defaultMessage:"Error occurred when updating subscription",id:"Applications.Details.Subscriptions.error.when.updating"}))}))}handleSubscribe(e,t,i){const a=new h.A,{intl:n}=this.props;i?a.subscribe(t,e,i).then((t=>{201!==t.status?xe.A.error(n.formatMessage({id:"Applications.Details.Subscriptions.error.occurred.during.subscription.not.201",defaultMessage:"Error occurred during subscription"})):("ON_HOLD"===t.body.status?xe.A.info(n.formatMessage({defaultMessage:"Your subscription request has been submitted and is now awaiting approval.",id:"subscription.pending"})):"TIER_UPDATE_PENDING"===t.body.status?xe.A.info(n.formatMessage({defaultMessage:"Your subscription update request has been submitted and is now awaiting approval.",id:"subscription.tierPending"})):xe.A.info(n.formatMessage({id:"Applications.Details.Subscriptions.subscription.successful",defaultMessage:"Subscription successful"})),this.updateSubscriptions(e),this.props.getApplication())})).catch((e=>{const{status:t}=e;401===t&&this.setState({isAuthorize:!1}),403===t&&e.response.body?xe.A.error(e.response.body.description):xe.A.error(n.formatMessage({id:"Applications.Details.Subscriptions.error.occurred.during.subscription",defaultMessage:"Error occurred during subscription"}))})):xe.A.error(n.formatMessage({id:"Applications.Details.Subscriptions.select.a.subscription.policy",defaultMessage:"Select a subscription policy"}))}handleSearchTextChange(){this.setState({searchText:this.searchTextTmp})}handleSearchTextTmpChange(e){this.searchTextTmp=e.target.value}handleClearSearch(){this.setState({searchText:""}),this.searchInputElem.value=""}handleEnterPress(e){13===e.keyCode&&(e.preventDefault(),this.handleSearchTextChange())}render(){const{isAuthorize:e,openDialog:t,searchText:i}=this.state;e||(window.location=A.app.context+"/services/configs");const{subscriptions:s,apisNotFound:l,subscriptionsNotFound:r}=this.state,{applicationId:o}=this.props.application,{intl:c}=this.props;return s?a.createElement(ct,null,a.createElement(n.A,{className:ot.root},a.createElement(n.A,{className:ot.titleWrapper},a.createElement(u.A,{variant:"h5",sx:{textTransform:"capitalize"}},a.createElement(m.A,{id:"Applications.Details.Subscriptions.subscription.management",defaultMessage:"Subscription Management"})),a.createElement(v.A,{color:"secondary",className:ot.buttonElm,size:"small",onClick:this.handleOpenDialog},a.createElement(Ee.A,null,"add_circle_outline"),a.createElement(m.A,{id:"Applications.Details.Subscriptions.subscription.management.add",defaultMessage:"Subscribe APIs"}))),a.createElement(w.Ay,{container:!0,sx:"tab-grid",spacing:2},a.createElement(w.Ay,{item:!0,xs:12,xl:11},s&&0===s.length||this.state.pseudoSubscriptions?a.createElement(n.A,{className:ot.genericMessageWrapper},a.createElement(He.A,{type:"info",sx:e=>({width:1e3,padding:e.spacing(2)})},a.createElement(u.A,{variant:"h5",component:"h3"},a.createElement(m.A,{id:"Applications.Details.Subscriptions.no.subscriptions",defaultMessage:"No Subscriptions Available"})),a.createElement(u.A,{component:"p"},a.createElement(m.A,{id:"Applications.Details.Subscriptions.no.subscriptions.content",defaultMessage:"No subscriptions are available for this Application"})))):a.createElement(n.A,{className:ot.cardContent},r?a.createElement(b.A,null):a.createElement(he.A,{className:ot.subsTable},a.createElement(be.A,null,a.createElement(ye.A,null,a.createElement(fe.A,{className:ot.firstCell},a.createElement(m.A,{id:"Applications.Details.Subscriptions.api.name",defaultMessage:"API"})),a.createElement(fe.A,null,a.createElement(m.A,{id:"Applications.Details.Subscriptions\n                                                                            .subscription.state",defaultMessage:"Lifecycle State"})),a.createElement(fe.A,null,a.createElement(m.A,{id:"Applications.Details.Subscriptions\n                                                                            .business.plan",defaultMessage:"Business Plan"})),a.createElement(fe.A,null,a.createElement(m.A,{id:"Applications.Details.Subscriptions.Status",defaultMessage:"Subscription Status"})),a.createElement(fe.A,null,a.createElement(m.A,{id:"Applications.Details.Subscriptions.action",defaultMessage:"Action"})))),a.createElement(Ae.A,null,s&&s.map((e=>a.createElement(lt,{key:e.subscriptionId,subscription:e,handleSubscriptionDelete:this.handleSubscriptionDelete,handleSubscriptionUpdate:this.handleSubscriptionUpdate})))))))),a.createElement(pt,{onClose:this.handleOpenDialog,"aria-labelledby":"simple-dialog-title",open:t,fullWidth:"true",maxWidth:"sm",className:ot.subscribePop},a.createElement(n.A,{className:ot.dialogHeader},a.createElement(k.A,{className:ot.dialogTitle,disableTypography:!0},a.createElement(u.A,{variant:"h6"},a.createElement(m.A,{id:"Applications.Details.Subscriptions.subscription.management.add",defaultMessage:"Subscribe APIs"}))),a.createElement(n.A,{className:ot.searchRoot},a.createElement(ge.A,{component:"form",className:ot.searchBar},i&&a.createElement(Se.A,{className:ot.clearSearchIcon,onClick:this.handleClearSearch}),a.createElement(ve.Ay,{className:ot.input,placeholder:c.formatMessage({defaultMessage:"Search APIs",id:"Applications.Details.Subscriptions.search"}),inputProps:{"aria-label":c.formatMessage({defaultMessage:"Search APIs",id:"Applications.Details.Subscriptions.search"})},inputRef:e=>{this.searchInputElem=e},onChange:this.handleSearchTextTmpChange,onKeyDown:this.handleEnterPress}),a.createElement(K.A,{className:ot.iconButton,"aria-label":"search",onClick:this.handleSearchTextChange,size:"large"},a.createElement(Me.default,null))),a.createElement(n.A,{className:ot.searchResults},i&&""!==i?a.createElement(a.Fragment,null,a.createElement(u.A,{variant:"caption"},a.createElement(m.A,{id:"Applications.Details.Subscriptions.filter.msg",defaultMessage:"Filtered APIs for"}),` ${i}`)):a.createElement(u.A,{variant:"caption"},a.createElement(m.A,{id:"Applications.Details.Subscriptions.filter.msg.all.apis",defaultMessage:"Displaying all APIs"})))),a.createElement(K.A,{"aria-label":"close",className:ot.closeButton,onClick:this.handleOpenDialog,size:"large"},a.createElement(Ee.A,null,"cancel"))),a.createElement(n.A,{padding:2},a.createElement(Fe,{apisNotFound:l,subscriptions:s,applicationId:o,handleSubscribe:(e,t,i)=>this.handleSubscribe(e,t,i),searchText:i}))))):a.createElement(Te.A,null)}}dt.propTypes={classes:r().shape({}).isRequired,intl:r().shape({}).isRequired};const ut=(0,g.Ay)(dt);var mt=i(60111),gt=i(46252),ht=i(32997),At=i(68738),ft=i(2587);function bt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class yt extends a.Component{constructor(e){super(e),bt(this,"isOrgWideAppUpdateEnabled",(()=>{const{settings:{orgWideAppUpdateEnabled:e}}=this.context;this.setState({isOrgWideAppUpdateEnabled:e})})),bt(this,"toggleDeleteConfirmation",(()=>{this.setState((e=>{let{isDeleteOpen:t}=e;return{isDeleteOpen:!t}}))})),this.state={notFound:!1,showOverview:!0,isDeleteOpen:!1,isOrgWideAppUpdateEnabled:!1},this.toggleOverview=this.toggleOverview.bind(this),this.handleAppDelete=this.handleAppDelete.bind(this),this.handleDeleteConfimation=this.handleDeleteConfimation.bind(this),this.toggleDeleteConfirmation=this.toggleDeleteConfirmation.bind(this)}componentDidMount(){this.isOrgWideAppUpdateEnabled()}handleAppDelete(){const{applicationId:e,intl:t,application:i}=this.props,a=gt.A.deleteApp(e);let n=t.formatMessage({defaultMessage:"In Application {name} deleted successfully!",id:"Applications.Details.InfoBar.application.deleted.successfully"},{name:i.name});a.then((e=>{200===e?(xe.A.info(n),this.toggleDeleteConfirmation()):201===e&&(xe.A.info(t.formatMessage({defaultMessage:"Delete request created for application {name}",id:"Applications.Listing.Listing.application.deleting.requested"},{name:i.name})),this.toggleDeleteConfirmation()),this.props.history.push("/applications")})).catch((e=>{console.log(e),n=t.formatMessage({defaultMessage:"Error while deleting application {name}",id:"Applications.Details.InfoBar.application.deleting.error"},{name:i.name}),xe.A.error(n)}))}handleDeleteConfimation(){const{isDeleteOpen:e}=this.state;this.setState({isDeleteOpen:!e})}toggleOverview(e){"boolean"==typeof e?this.setState({showOverview:e}):this.setState((e=>({showOverview:!e.showOverview})))}render(){const{applicationId:e,application:t}=this.props,i=this.props.application.owner,{notFound:s,isDeleteOpen:l,isOrgWideAppUpdateEnabled:r}=this.state;if(s)return a.createElement(b.A,{message:a.createElement(m.A,{id:"Applications.Details.InfoBar.listing.resource.not.found",defaultMessage:"Resource Not Fount"})});if(!t)return a.createElement(f.A,null);const c=ht.A.getUser().name===i;return a.createElement(n.A,{sx:{width:"100%"}},a.createElement(n.A,{sx:e=>({height:e.custom.infoBar.height||70,background:e.custom.infoBar.background||"#ffffff",color:e.palette.getContrastText(e.custom.infoBar.background||"#ffffff"),borderBottom:"solid 1px "+e.palette.grey.A200,display:"flex",alignItems:"center",paddingLeft:e.spacing(2)})},a.createElement(w.Ay,{item:!0,xs:10},a.createElement(n.A,{sx:e=>({marginLeft:e.spacing(1)})},a.createElement(o.N_,{to:"/applications/"+e+"/overview",className:e=>({color:e.palette.getContrastText(e.custom.infoBar.background)})},a.createElement(u.A,{id:"itest-info-bar-application-name",variant:"h4"},t.name))),a.createElement(n.A,{sx:e=>({marginLeft:e.spacing(1)})},a.createElement(u.A,{variant:"caption",gutterBottom:!0,align:"left",noWrap:!0},t.subscriptionCount," ",a.createElement(m.A,{id:"Applications.Details.InfoBar.subscriptions",defaultMessage:"Subscriptions"})))),(r||c)&&a.createElement(w.Ay,{container:!0,justifyContent:"flex-end"},a.createElement(mt.A,{height:70}),a.createElement(w.Ay,{item:!0,xs:1,m:3,sx:e=>({display:"inline-grid",cursor:"pointer",justifyContent:"center","& .material-icons, & span":{color:e.palette.getContrastText(e.custom.infoBar.background)}})},a.createElement(o.N_,{to:`/applications/${e}/edit/fromView`,sx:e=>({display:"inline-grid",cursor:"pointer","& .material-icons, & span":{color:e.palette.getContrastText(e.custom.infoBar.background)}})},a.createElement(v.A,{id:"edit-application",style:{padding:"4px",display:"flex",flexDirection:"column"},color:"grey",classes:{label:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},"aria-label":a.createElement(m.A,{id:"Applications.Details.InfoBar.edit",defaultMessage:"Edit"})},a.createElement(Ee.A,null,"edit"),a.createElement(u.A,{variant:"caption",style:{marginTop:"2px"}},a.createElement(m.A,{id:"Applications.Details.InfoBar.edit.text",defaultMessage:"Edit"}))))),a.createElement(mt.A,{height:70}),a.createElement(w.Ay,{item:!0,xs:1,m:1,sx:e=>({display:"inline-grid",cursor:"pointer","& .material-icons, & span":{color:e.palette.getContrastText(e.custom.infoBar.background)}})},a.createElement(v.A,{id:"delete-application",onClick:this.handleDeleteConfimation,style:{padding:"4px",display:"flex",flexDirection:"column"},disabled:!r&&ht.A.getUser().name!==i||"DELETE_PENDING"===this.props.application.status,color:"grey",classes:{label:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},"aria-label":a.createElement(m.A,{id:"Applications.Details.InfoBar.delete",defaultMessage:"Delete"})},a.createElement(Ee.A,null,"delete"),a.createElement(u.A,{variant:"caption",style:{marginTop:"2px"}},a.createElement(m.A,{id:"Applications.Details.InfoBar.text",defaultMessage:"Delete"}))),a.createElement(ft.A,{handleAppDelete:this.handleAppDelete,isDeleteOpen:l,toggleDeleteConfirmation:this.toggleDeleteConfirmation})))))}}yt.contextType=At.Ay,yt.propTypes={classes:r().shape({}).isRequired,theme:r().shape({}).isRequired,applicationId:r().string.isRequired};const Et=(0,g.Ay)((0,c.y)(yt));var vt=i(6442),St=i(57555),Mt=i(90891);const Tt=e=>{const{handleResetThrottlePolicy:t,isResetOpen:i,toggleResetConfirmation:n}=e,[s,l]=(0,a.useState)(""),[r,o]=(0,a.useState)(1),[c,p]=(0,a.useState)(!0),d=(0,vt.A)();return a.createElement(S.A,{open:i,transition:Ge.A,role:"alertdialog"},1===r?a.createElement(a.Fragment,null,a.createElement(k.A,null,a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.title",defaultMessage:"Reset Application Throttle Policy"}),a.createElement(z.A,{interactive:!0,title:a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.text.description.tooltip",defaultMessage:"Check the username properly before submitting since User will not be validated. Only a Policy Reset Request will be generated for the specified user"}),placement:"right",style:{marginLeft:"20px",maxWidth:500}},a.createElement(K.A,{style:{marginLeft:"10px"}},a.createElement(Mt.A,null)))),a.createElement(T.A,null,a.createElement(x.A,null,a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.text.description",defaultMessage:"Enter the user of the application"})),a.createElement(I.A,{autoFocus:!0,type:"text",value:s,onChange:e=>{var t;l(e.target.value),(t=e.target.value)&&""!==t.trim()?(p(!0),Promise.resolve(!0)):(p(!1),Promise.reject(new Error(d.formatMessage({id:"Applications.Listing.ResetPolicyDialog.dialog.user.required",defaultMessage:"Application name is required"}))))},id:"application-name",margin:"normal",variant:"outlined",required:!0,fullWidth:!0,label:d.formatMessage({defaultMessage:"User",id:"Applications.Listing.ResetPolicyDialog.dialog.user"}),name:"user",error:!c,inputProps:{maxLength:70,alt:d.formatMessage({defaultMessage:"Required",id:"Applications.Listing.ResetPolicyDialog.dialog.required.alt"})}})),a.createElement(M.A,null,a.createElement(v.A,{onClick:n},a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.cancel",defaultMessage:"Cancel"})),a.createElement(v.A,{id:"next-button",size:"small",variant:"outlined",color:"primary",onClick:()=>{o(2)},disabled:!s},a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.next",defaultMessage:"Next"})))):a.createElement(a.Fragment,null,a.createElement(k.A,null,a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.confirmation.title",defaultMessage:"Confirm Reset"})),a.createElement(T.A,null,a.createElement(x.A,null,a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.confirmation.text",defaultMessage:"Are you sure you want to reset the throttle policy for user {user}?",values:{user:s}}))),a.createElement(M.A,null,a.createElement(v.A,{onClick:()=>{o(1)}},a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.back",defaultMessage:"Back"})),a.createElement(v.A,{id:"reset-button",size:"small",variant:"outlined",color:"primary",onClick:()=>{""!==s&&(t(s),n(),l(""),o(1))}},a.createElement(m.A,{id:"Applications.Listing.ResetPolicyDialog.dialog.reset",defaultMessage:"Reset"})))))};Tt.propTypes={handleResetThrottlePolicy:r().func.isRequired,isResetOpen:r().bool.isRequired,toggleResetConfirmation:r().func.isRequired};const xt=Tt,kt="Overview",Dt={root:`${kt}-root`,table:`${kt}-table`,leftCol:`${kt}-leftCol`,iconAligner:`${kt}-iconAligner`,iconTextWrapper:`${kt}-iconTextWrapper`,iconEven:`${kt}-iconEven`,iconOdd:`${kt}-iconOdd`,heading:`${kt}-heading`,emptyBox:`${kt}-emptyBox`,summaryRoot:`${kt}-summaryRoot`,actionPanel:`${kt}-actionPanel`,disabledTier:`${kt}-disabledTier`,Paper:`${kt}-Paper`,Paper2:`${kt}-Paper2`,list:`${kt}-list`,urlPaper:`${kt}-urlPaper`,input:`${kt}-input`,avatar:`${kt}-avatar`,iconStyle:`${kt}-iconStyle`,infoButton:`${kt}-infoButton`},wt=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{[`& .${Dt.root}`]:{padding:t.spacing(3,2),"& td, & th":{color:t.palette.getContrastText(t.custom.infoBar.background)},background:t.custom.infoBar.background},[`& .${Dt.table}`]:{minWidth:"100%"},[`& .${Dt.leftCol}`]:{width:200},[`& .${Dt.iconAligner}`]:{display:"flex",justifyContent:"flex-start",alignItems:"center"},[`& .${Dt.iconTextWrapper}`]:{display:"inline-block",paddingLeft:20},[`& .${Dt.iconEven}`]:{color:t.custom.infoBar.iconOddColor,width:t.spacing(3)},[`& .${Dt.iconOdd}`]:{color:t.custom.infoBar.iconOddColor,width:t.spacing(3)},[`& .${Dt.heading}`]:{color:t.palette.getContrastText(t.palette.background.paper),paddingLeft:t.spacing(1)},[`& .${Dt.emptyBox}`]:{background:"#ffffff55",color:t.palette.getContrastText(t.palette.background.paper),border:"solid 1px #fff",padding:t.spacing(2),width:"100%"},[`& .${Dt.summaryRoot}`]:{display:"flex",alignItems:"center"},[`& .${Dt.actionPanel}`]:{justifyContent:"flex-start"},[`& .${Dt.disabledTier}`]:{color:"#999999",fontWeight:"400"},[`& .${Dt.Paper}`]:{marginTop:t.spacing(2),padding:t.spacing(2)},[`& .${Dt.Paper2}`]:{marginTop:t.spacing(2),padding:t.spacing(2),height:"80%"},[`& .${Dt.list}`]:{width:"100%",maxWidth:800,backgroundColor:t.palette.background.paper,position:"relative",overflow:"auto",maxHeight:175},[`& .${Dt.urlPaper}`]:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%",border:`solid 1px ${t.palette.grey[300]}`,"& .MuiInputBase-root:before,  .MuiInputBase-root:hover":{borderBottom:"none !important",color:t.palette.primary.main},"& .MuiSelect-select":{color:t.palette.primary.main,paddingLeft:t.spacing()},"& .MuiInputBase-input":{color:t.palette.primary.main},"& .material-icons":{fontSize:16,color:`${t.palette.grey[700]} !important`},borderRadius:10,marginRight:t.spacing()},[`& .${Dt.input}`]:{marginLeft:t.spacing(1),flex:1},[`& .${Dt.avatar}`]:{width:30,height:30,background:"transparent",border:`solid 1px ${t.palette.grey[300]}`},[`& .${Dt.iconStyle}`]:{cursor:"pointer",margin:"-10px 0",padding:"0 0 0 5px","& .material-icons":{fontSize:18,color:"#9c9c9c"}},[`& .${Dt.infoButton}`]:{marginLeft:t.spacing(1),color:t.palette.grey[600]}}})),Pt=(0,g.Ay)((function(e){const[t,i]=(0,a.useState)(null),[n,s]=(0,a.useState)(null),[l,r]=(0,a.useState)(!1),{match:{params:{applicationId:o}}}=e,[c,p]=(0,a.useState)(null),[d,g]=(0,a.useState)(!1),[A,y]=(0,a.useState)(null),[E,S]=(0,a.useState)(null),[M,T]=(0,a.useState)(null),[x,k]=(0,a.useState)(!1),D=(0,vt.A)();return(0,a.useEffect)((()=>{const e=new h.A;e.getApplication(o).then((t=>{const a=t.obj;i(a),e.getTierByName(t.obj.throttlingPolicy,"application").then((e=>{s(e.obj.description),a.solaceDeployedEnvironments&&(p(a.solaceDeployedEnvironments[0]),y(a.solaceDeployedEnvironments[0].solaceURLs[0].protocol),S(a.solaceDeployedEnvironments[0].solaceURLs[0].endpointURL),"mqtt"===a.solaceDeployedEnvironments[0].solaceURLs[0].protocol?T(a.solaceDeployedEnvironments[0].SolaceTopicsObject.mqttSyntax):T(a.solaceDeployedEnvironments[0].SolaceTopicsObject.defaultSyntax))})).catch((e=>{g(!0),s("Tier is disabled."),console.log(e)}))})).catch((e=>{const{status:t}=e;r(404===t)}))}),[]),l?a.createElement(b.A,null):t?(c&&(console.log(c),console.log(M)),a.createElement(wt,null,a.createElement("div",{className:Dt.root},a.createElement(he.A,{className:Dt.table},a.createElement(Ae.A,null,a.createElement(ye.A,null,a.createElement(fe.A,{component:"th",scope:"row",className:Dt.leftCol},a.createElement("div",{className:Dt.iconAligner},a.createElement(Ee.A,{className:Dt.iconEven},"description"),a.createElement("span",{className:Dt.iconTextWrapper},a.createElement(u.A,{variant:"caption",gutterBottom:!0,align:"left"},a.createElement(m.A,{id:"Applications.Details.Overview.description",defaultMessage:"Description"}))))),a.createElement(fe.A,null,t.description)),a.createElement(ye.A,null,a.createElement(fe.A,{component:"th",scope:"row",className:Dt.leftCol},a.createElement("div",{className:Dt.iconAligner},a.createElement(Ee.A,{className:Dt.iconOdd},"settings_input_component"),a.createElement("span",{className:Dt.iconTextWrapper},a.createElement(u.A,{variant:"caption",gutterBottom:!0,align:"left"},a.createElement(m.A,{id:"Applications.Details.InfoBar.business.plan",defaultMessage:"Business Plan"}))))),t&&a.createElement(fe.A,{className:Dt.iconAligner},t.throttlingPolicy,n&&n.trim()&&a.createElement("span",{className:d?Dt.disabledTier:""},"",`(${n.trim()})`),a.createElement(mt.A,{height:40}),a.createElement(w.Ay,{item:!0,xs:1,m:1},a.createElement(v.A,{id:"reset-application-policy",style:{padding:"1px"},onClick:()=>{k(!0)},color:"grey","aria-label":a.createElement(m.A,{id:"Applications.Details.Overview.application.reset",defaultMessage:"Reset"})},a.createElement(Ee.A,null,"replay"),a.createElement(u.A,{variant:"caption"},a.createElement(m.A,{id:"Applications.Details.Overview.application.reset.text",defaultMessage:"RESET"}))),a.createElement(z.A,{interactive:!0,title:a.createElement(m.A,{id:"Applications.Details.Overview.application.reset.tooltip",defaultMessage:"Reset the Application Throttle Policy for a Specific User"}),placement:"right",classeName:Dt.infoToolTip},a.createElement(K.A,{className:Dt.infoButton,"aria-label":"arch"},a.createElement(Mt.A,null))),a.createElement(xt,{handleResetThrottlePolicy:e=>{(new h.A).resetApplicationPolicy(e,t.applicationId).then((t=>{200===t.status&&xe.A.success(D.formatMessage({defaultMessage:"Application Policy Reset request for {name} has been triggered successfully",id:"Applications.Details.Overview.reset.successful"},{name:e}))})).catch((t=>{const{response:i}=t;null!=i&&i.body&&(400===t.status?xe.A.error(i.body.description):xe.A.error(D.formatMessage({defaultMessage:"Error while resetting application policy for {name}",id:"Applications.Details.Overview.reset.error"},{name:e})))}))},isResetOpen:x,toggleResetConfirmation:()=>{k(!1)}})))),a.createElement(ye.A,null,a.createElement(fe.A,{component:"th",scope:"row",className:Dt.leftCol},a.createElement("div",{className:Dt.iconAligner},a.createElement(Ee.A,{className:Dt.iconOdd},"assignment_turned_in"),a.createElement("span",{className:Dt.iconTextWrapper},a.createElement(u.A,{variant:"caption",gutterBottom:!0,align:"left"},a.createElement(m.A,{id:"Applications.Details.Overview.workflow.status",defaultMessage:"Workflow Status"}))))),a.createElement(fe.A,null,t.status)),a.createElement(ye.A,null,a.createElement(fe.A,{component:"th",scope:"row",className:Dt.leftCol},a.createElement("div",{className:Dt.iconAligner},a.createElement(Ee.A,{className:Dt.iconEven},"account_box"),a.createElement("span",{className:Dt.iconTextWrapper},a.createElement(u.A,{variant:"caption",gutterBottom:!0,align:"left"},a.createElement(m.A,{id:"Applications.Details.Overview.application.owner",defaultMessage:"Application Owner"}))))),a.createElement(fe.A,null,t.owner)),t.attributes&&Object.keys(t.attributes).map(((e,i)=>{const n=t.attributes[e];return a.createElement(ye.A,{key:e},a.createElement(fe.A,{component:"th",scope:"row",className:Dt.leftCol},a.createElement("div",{className:Dt.iconAligner},a.createElement(Ee.A,{className:me()({[Dt.iconEven]:i%2!=0},{[Dt.iconOdd]:i%2==0})},"web_asset"),a.createElement("span",{className:Dt.iconTextWrapper},a.createElement(u.A,{variant:"caption",gutterBottom:!0,align:"left"},e)))),a.createElement(fe.A,null,n))})))),!0===t.containsSolaceApis&&c&&M&&a.createElement("div",{className:Dt.root},a.createElement(u.A,{id:"itest-api-details-bushiness-plans-head",variant:"h5"},a.createElement(m.A,{id:"solace.application.available.topics.heading",defaultMessage:"Available Topics"})),a.createElement(u.A,{variant:"caption",gutterBottom:!0},a.createElement(m.A,{id:"solace.application.available.topics.subheading",defaultMessage:"Topics permitted to access from solace applications"})),a.createElement(ge.A,{className:Dt.Paper},a.createElement(w.Ay,{container:!0,spacing:2},a.createElement(w.Ay,{item:!0,xs:12},a.createElement(w.Ay,{container:!0,spacing:2},a.createElement(w.Ay,{item:!0},a.createElement(I.A,{select:!0,onChange:e=>{p(e.target.value),console.log(e.target.value)},value:c.environmentDisplayName,style:{maxWidth:"100%"},variant:"outlined",label:"Environment Name"},t.solaceDeployedEnvironments.map((e=>a.createElement(Pe.A,{key:e,value:e.environmentDisplayName},e.environmentDisplayName))))),a.createElement(w.Ay,{item:!0},a.createElement(I.A,{select:!0,onChange:e=>{let t;y(e.target.value),c.solaceURLs.map((i=>(i.protocol===e.target.value&&(S(i.endpointURL),t=i.protocol),null))),T("mqtt"===t?c.SolaceTopicsObject.mqttSyntax:c.SolaceTopicsObject.defaultSyntax)},value:A,style:{maxWidth:"100%"},variant:"outlined",label:"Protocol"},c.solaceURLs.map((e=>a.createElement(Pe.A,{key:e.protocol,value:e.protocol},(0,St.mf)(e.protocol)))))),a.createElement(w.Ay,{item:!0},a.createElement(I.A,{style:{minWidth:"200%"},label:"Endpoint URL",value:E,variant:"outlined"})))),a.createElement(w.Ay,{item:!0,xs:6},a.createElement(ge.A,{className:Dt.Paper2},a.createElement(u.A,{id:"itest-api-details-bushiness-plans-head",variant:"h6"},a.createElement(m.A,{id:"solace.application.topics.publish",defaultMessage:"Publish Topics"})),a.createElement(V.A,{className:Dt.list},M.publishTopics.map((e=>a.createElement(H.Ay,null,a.createElement(u.A,{gutterBottom:!0,align:"left"},e))))))),a.createElement(w.Ay,{item:!0,xs:6},a.createElement(ge.A,{className:Dt.Paper2},a.createElement(u.A,{id:"itest-api-details-bushiness-plans-head",variant:"h6"},a.createElement(m.A,{id:"solace.application.topics.subscribe",defaultMessage:"Subscribe Topics"})),a.createElement(V.A,{className:Dt.list},M.subscribeTopics.map((e=>a.createElement(H.Ay,null,a.createElement(u.A,{gutterBottom:!0,align:"left"},e))))))))))))):a.createElement(f.A,null)}));var It=i(71543),Rt=i(20889),Ct=i(2543),$t=i.n(Ct),Nt=i(74353),Lt=i.n(Nt),Ot=i(6279),Bt=i.n(Ot),qt=i(82299),Ut=i(66325);const Wt="WebHookDetails",Kt={buttonIcon:`${Wt}-buttonIcon`,paper:`${Wt}-paper`,grid:`${Wt}-grid`,userNotificationPaper:`${Wt}-userNotificationPaper`,titleSub:`${Wt}-titleSub`,root:`${Wt}-root`,titleWrapper:`${Wt}-titleWrapper`,listWrapper:`${Wt}-listWrapper`,subscriptionRow:`${Wt}-subscriptionRow`,callbackurl:`${Wt}-callbackurl`,subscriptionTimestamp:`${Wt}-subscriptionTimestamp`,SubscriptionHeader:`${Wt}-SubscriptionHeader`},jt=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{[`& .${Kt.buttonIcon}`]:{marginRight:10},[`& .${Kt.paper}`]:{margin:t.spacing(1),padding:t.spacing(1)},[`& .${Kt.grid}`]:{marginTop:t.spacing(4),marginBottom:t.spacing(4),paddingRight:t.spacing(2),justifyContent:"center"},[`& .${Kt.userNotificationPaper}`]:{padding:t.spacing(2)},[`& .${Kt.titleSub}`]:{marginLeft:t.spacing(2),paddingTop:t.spacing(2),paddingBottom:t.spacing(2)},[`&.${Kt.root}`]:{padding:t.spacing(3),"& h5":{color:t.palette.getContrastText(t.palette.background.default)}},[`& .${Kt.titleWrapper}`]:{display:"flex",alignItems:"center",paddingBottom:t.spacing(2),"& h5":{marginRight:t.spacing(1)}},[`& .${Kt.listWrapper}`]:{width:"50%"},[`& .${Kt.subscriptionRow}`]:{paddingLeft:"16px"},[`& .${Kt.callbackurl}`]:{fontSize:"12px"},[`& .${Kt.subscriptionTimestamp}`]:{float:"right"},[`& .${Kt.SubscriptionHeader}`]:{paddingBottom:"0px",paddingLeft:"0px",paddingTop:"0px"}}}));function zt(e){const{location:{pathname:t}}=e,i=(0,vt.A)(),n=(0,c.B6)(t,{path:"/applications/:applicationId/webhooks/:apiId",exact:!0,strict:!1}),{applicationId:s}=e.match.params,{apiId:l}=n.params,[r,o]=(0,a.useState)("");return(0,a.useEffect)((()=>{(new h.A).getWebhookubScriptions(l,s).then((e=>{const t=$t().groupBy(e.obj.list,"topic");o(t)})).catch((e=>{console.log(e),xe.A.error(i.formatMessage({id:"Applications.Details.Subscriptions.error.occurred.webhook.subscription",defaultMessage:"Error while retrieving webhook subscriptions"}))}))}),[]),a.createElement(jt,{className:Kt.root},a.createElement("div",{className:Kt.titleWrapper},a.createElement(u.A,{variant:"h5",className:Kt.keyTitle},a.createElement(m.A,{id:"Applications.Details.Subscriptions.api.webhooks",defaultMessage:"Web Hooks"}))),a.createElement(V.A,{className:Kt.listWrapper},Object.keys(r).length<1&&a.createElement(u.A,{color:"textPrimary",display:"block"},a.createElement(m.A,{id:"Applications.Details.Subscriptions.api.webhooks.subscriptions.unavailable",defaultMessage:"No Webhook subscriptions available at this time."})),Object.keys(r).map((e=>a.createElement(a.Fragment,null,a.createElement(H.Ay,{className:Kt.SubscriptionHeader},a.createElement(Y.A,{primary:e})),r[e].map((e=>a.createElement(w.Ay,{container:!0,direction:"row"},a.createElement(w.Ay,{item:!0,xs:1},(e=>{switch(e.deliveryStatus){case 1:return a.createElement(Rt.A,{style:{color:"green",fontSize:"14px",paddingTop:"3px"}});case 2:return a.createElement(qt.A,{style:{color:"red",fontSize:"14px",paddingTop:"3px"}});default:return a.createElement(Ut.A,{style:{color:"black",fontSize:"14px",paddingTop:"3px"}})}})(e)),a.createElement(w.Ay,{item:!0,xs:8},a.createElement(u.A,{color:"textPrimary",display:"block",className:Kt.callbackurl},e.callBackUrl)),a.createElement(w.Ay,{item:!0,xs:3},e.deliveryTime?a.createElement(u.A,{color:"textSecondary",display:"block",variant:"caption",className:Kt.subscriptionTimestamp},e.deliveryTime):a.createElement(u.A,{color:"textSecondary",display:"block",variant:"caption",className:Kt.subscriptionTimestamp},a.createElement(m.A,{id:"Applications.Details.Subscriptions.api.webhooks.delivery.time.unavailable",defaultMessage:"Delivery data unavailable"}))),a.createElement(It.A,{component:"li"})))),a.createElement(It.A,{component:"li"}))))))}function _t(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Lt().extend(Bt());const Ft="index",Vt={LeftMenu:`${Ft}-LeftMenu`,leftMenuHorizontal:`${Ft}-leftMenuHorizontal`,leftMenuVerticalLeft:`${Ft}-leftMenuVerticalLeft`,leftMenuVerticalRight:`${Ft}-leftMenuVerticalRight`,leftLInkMain:`${Ft}-leftLInkMain`,leftLInkMainText:`${Ft}-leftLInkMainText`,detailsContent:`${Ft}-detailsContent`,content:`${Ft}-content`,contentLoader:`${Ft}-contentLoader`,contentLoaderRightMenu:`${Ft}-contentLoaderRightMenu`,titleWrapper:`${Ft}-titleWrapper`,contentWrapper:`${Ft}-contentWrapper`,keyTitle:`${Ft}-keyTitle`},Ht=(0,s.Ay)("div")((e=>{let{theme:t}=e;return{width:"100%",[`& .${Vt.LeftMenu}`]:{backgroundColor:t.custom.leftMenu.background,backgroundImage:`url(${A.app.context}${t.custom.leftMenu.backgroundImage})`,textAlign:"left",fontFamily:t.typography.fontFamily,position:"absolute",bottom:0,paddingLeft:"horizontal"===t.custom.leftMenu.position?t.spacing(3):0},[`& .${Vt.leftMenuHorizontal}`]:{top:t.custom.infoBar.height,width:"100%",overflowX:"auto",height:60,display:"flex",left:0},[`& .${Vt.leftMenuVerticalLeft}`]:{width:t.custom.leftMenu.width,top:0,left:0,overflowY:"auto",[t.breakpoints.down("md")]:{width:50}},[`& .${Vt.leftMenuVerticalRight}`]:{width:t.custom.leftMenu.width,top:0,right:0,overflowY:"auto",[t.breakpoints.down("md")]:{width:50}},[`& .${Vt.leftLInkMain}`]:{borderRight:"solid 1px "+t.custom.leftMenu.background,cursor:"pointer",background:t.custom.leftMenu.rootBackground,color:t.palette.getContrastText(t.custom.leftMenu.rootBackground),textDecoration:"none",alignItems:"center",justifyContent:"center",display:"flex",height:t.custom.infoBar.height},[`& .${Vt.leftLInkMainText}`]:{fontSize:18,color:t.palette.grey[500],textDecoration:"none",paddingLeft:t.spacing(2)},[`& .${Vt.detailsContent}`]:{display:"flex",flex:1},[`& .${Vt.content}`]:{display:"flex",flex:1,flexDirection:"column",marginLeft:"vertical-left"===t.custom.leftMenu.position?t.custom.leftMenu.width-4:0,marginRight:"vertical-right"===t.custom.leftMenu.position?t.custom.leftMenu.width:0,paddingBottom:t.spacing(3),overflowX:"hidden",[t.breakpoints.down("md")]:{marginLeft:0!=("vertical-left"===t.custom.leftMenu.position?t.custom.leftMenu.width-4:0)&&50,marginRight:0!==("vertical-right"===t.custom.leftMenu.position?t.custom.leftMenu.width:0)&&50}},[`& .${Vt.contentLoader}`]:{paddingTop:t.spacing(3)},[`& .${Vt.contentLoaderRightMenu}`]:{paddingRight:t.custom.leftMenu.width},[`& .${Vt.titleWrapper}`]:{paddingLeft:25,paddingTop:28,textTransform:"capitalize"},[`& .${Vt.contentWrapper}`]:{paddingLeft:25},[`& .${Vt.keyTitle}`]:{textTransform:"capitalize"}}}));class Gt extends a.Component{constructor(e){super(e),_t(this,"getApplication",(()=>{const e=new h.A,t=this.props.match.params.application_uuid;e.getApplication(t).then((e=>(this.setState({application:e.obj}),Promise.all([e])))).catch((e=>{const{status:t}=e;404===t&&this.setState({notFound:!0})}))})),_t(this,"handleMenuSelect",(e=>{const{history:t,match:i}=this.props;t.push({pathname:"/applications/"+i.params.application_uuid+"/"+e})})),_t(this,"toTitleCase",(e=>e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())))),_t(this,"renderManager",((e,t,i)=>a.createElement(ge.A,null,"oauth"===i&&a.createElement(E.A,{keyType:t,selectedApp:{appId:e.applicationId,label:e.name,tokenType:e.tokenType,owner:e.owner,hashEnabled:e.hashEnabled}}),"apikey"===i&&a.createElement("div",{className:Vt.root},a.createElement("div",{className:Vt.titleWrapper},a.createElement(u.A,{variant:"h5",className:Vt.keyTitle},this.toTitleCase(t),a.createElement(m.A,{id:"Applications.Details.api.keys.title",defaultMessage:" API Key"}))),a.createElement("div",{className:Vt.contentWrapper},a.createElement(de,{keyType:t,selectedApp:{appId:e.applicationId,label:e.name,tokenType:e.tokenType,owner:e.owner}})))))),this.state={application:null},this.getApplication=this.getApplication.bind(this)}componentDidMount(){this.getApplication()}render(){const{match:e,intl:t}=this.props,{notFound:i,application:s}=this.state,l="/applications/"+e.params.application_uuid,r=l+"/overview";return i?a.createElement(b.A,null):s?a.createElement(Ht,null,a.createElement("nav",{role:"navigation","aria-label":t.formatMessage({id:"Applications.Details.index.secondary.navigation",defaultMessage:"Secondary Navigation"}),className:me()(Vt.LeftMenu,{[Vt.leftMenuHorizontal]:!1},{[Vt.leftMenuVerticalLeft]:!0},{[Vt.leftMenuVerticalRight]:!1},"left-menu")},!1,a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.overview",defaultMessage:"Overview"}),iconText:"overview",route:"overview",to:l+"/overview",open:!0}),a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.prod.keys",defaultMessage:"Production Keys"}),iconText:"productionkeys",route:"productionkeys",to:l+"/productionkeys/oauth",open:!0,id:"production-keys"}),a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.oauth.tokens",defaultMessage:"OAuth2 Tokens"}),route:"productionkeys/oauth",to:l+"/productionkeys/oauth",submenu:!0,Icon:a.createElement(d.A,null),open:!0,id:"production-keys-oauth"}),a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.api.key",defaultMessage:"API Key"}),route:"productionkeys/apikey",to:l+"/productionkeys/apikey",submenu:!0,Icon:a.createElement(p.A,null),open:!0,id:"production-keys-apikey"}),a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.sandbox.keys",defaultMessage:"Sandbox Keys"}),iconText:"productionkeys",route:"sandboxkeys",to:l+"/sandboxkeys/oauth",open:!0,id:"sandbox-keys"}),a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.oauth.tokens",defaultMessage:"OAuth2 Tokens"}),route:"sandboxkeys/oauth",to:l+"/sandboxkeys/oauth",submenu:!0,Icon:a.createElement(d.A,null),open:!0,id:"sandbox-keys-oauth"}),a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.api.key",defaultMessage:"API Key"}),route:"sandboxkeys/apikey",to:l+"/sandboxkeys/apikey",submenu:!0,Icon:a.createElement(p.A,null),open:!0,id:"sandbox-keys-apikey"}),a.createElement(y.A,{text:a.createElement(m.A,{id:"Applications.Details.menu.subscriptions",defaultMessage:"Subscriptions"}),iconText:"subscriptions",route:"subscriptions",to:l+"/subscriptions",open:!0,id:"left-menu-subscriptions"})),a.createElement(n.A,{sx:e=>({display:"flex",flex:1,flexDirection:"column",marginLeft:"vertical-left"===e.custom.leftMenu.position?e.custom.leftMenu.width-158:0,paddingBottom:e.spacing(3),overflowX:"hidden",[e.breakpoints.down("md")]:{marginLeft:0!=("vertical-left"===e.custom.leftMenu.position?e.custom.leftMenu.width-4:0)&&50}})},a.createElement(Et,{application:s,applicationId:e.params.application_uuid,innerRef:e=>{this.infoBar=e}}),a.createElement("div",{className:me()({[Vt.contentLoader]:!1},{[Vt.contentLoaderRightMenu]:!1})},a.createElement(c.dO,null,a.createElement(c.rd,{exact:!0,from:"/applications/:applicationId",to:r}),a.createElement(c.qh,{path:"/applications/:applicationId/overview",component:Pt}),a.createElement(c.qh,{path:"/applications/:applicationId/webhooks/:apiId",component:zt}),a.createElement(c.qh,{path:"/applications/:applicationId/productionkeys/oauth",component:()=>this.renderManager(s,"PRODUCTION","oauth")}),a.createElement(c.qh,{path:"/applications/:applicationId/productionkeys/apikey",component:()=>this.renderManager(s,"PRODUCTION","apikey")}),a.createElement(c.qh,{path:"/applications/:applicationId/sandboxkeys/oauth",component:()=>this.renderManager(s,"SANDBOX","oauth")}),a.createElement(c.qh,{path:"/applications/:applicationId/sandboxkeys/apikey",component:()=>this.renderManager(s,"SANDBOX","apikey")}),a.createElement(c.qh,{path:"/applications/:applicationId/subscriptions",render:()=>a.createElement(ut,{application:s,getApplication:this.getApplication})}),a.createElement(c.qh,{component:b.A}))))):a.createElement(f.A,null)}}Gt.propTypes={classes:r().shape({}).isRequired,theme:r().shape({}).isRequired,match:r().shape({params:r().shape({application_uuid:r().string.isRequired}).isRequired}).isRequired,history:r().shape({push:r().func.isRequired}).isRequired,intl:r().shape({formatMessage:r().func}).isRequired};const Yt=(0,g.Ay)(Gt)},2587:(e,t,i)=>{i.d(t,{A:()=>h});var a=i(96540),n=i(58031),s=i(46831),l=i(22477),r=i(77867),o=i(58763),c=i(84798),p=i(48875),d=i(58065),u=i(5556),m=i.n(u);const g=e=>{const{handleAppDelete:t,isDeleteOpen:i,toggleDeleteConfirmation:u}=e;return a.createElement(n.A,{open:i,transition:p.A,role:"alertdialog"},a.createElement(s.A,null,a.createElement(d.A,{id:"Applications.Listing.DeleteConfirmation.dialog.title",defaultMessage:"Delete Application"})),a.createElement(l.A,null,a.createElement(r.A,null,a.createElement(d.A,{id:"Applications.Listing.DeleteConfirmation.dialog.text.description",defaultMessage:"The application will be removed"}))),a.createElement(o.A,null,a.createElement(c.A,{dense:!0,color:"grey",onClick:u},a.createElement(d.A,{id:"Applications.Listing.DeleteConfirmation.dialog.cancel",defaultMessage:"Cancel"})),a.createElement(c.A,{id:"itest-confirm-application-delete",size:"small",variant:"outlined",color:"primary",onClick:t},a.createElement(d.A,{id:"Applications.Listing.DeleteConfirmation.dialog,delete",defaultMessage:"Delete"}))))};g.propTypes={handleAppDelete:m().func.isRequired,isDeleteOpen:m().bool.isRequired,toggleDeleteConfirmation:m().func.isRequired};const h=g},57555:(e,t,i)=>{function a(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function n(e){return e.toUpperCase()}i.d(t,{Zr:()=>a,mf:()=>n})}}]);
//# sourceMappingURL=ApplicationDetails.7756f71d6d689164435a.bundle.js.map