"use strict";(this.webpackChunk_wso2apim_devportal=this.webpackChunk_wso2apim_devportal||[]).push([[7100],{27100:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var a=r(96540),s=r(11848),n=r(58065),o=r(32997),d=r(30198),i=r.n(d),l=r(55902),c=r.n(l),m=r(69067),p=r(99020),w=r(84798),u=r(1043),g=r(33551),h=r(34339),f=r(5556),P=r.n(f);const y="ChangePasswordBase",E={createTitle:`${y}-createTitle`,formContent:`${y}-formContent`},C=(0,s.Ay)(m.A)((e=>{let{theme:t}=e;return{[`& .${E.createTitle}`]:{color:t.palette.getContrastText(t.palette.background.default)},[`& .${E.formContent}`]:{"& span, & div, & p, & input":{color:t.palette.getContrastText(t.palette.background.paper)}}}}));function A(e){const{title:t,children:r}=e;return a.createElement(C,{width:1,mt:5},a.createElement(p.Ay,{justifyContent:"center",container:!0,spacing:3},a.createElement(p.Ay,{item:!0,sm:6,md:4},a.createElement(p.Ay,{container:!0,spacing:4},a.createElement(p.Ay,{item:!0,md:12,className:E.createTitle},t),a.createElement(p.Ay,{item:!0,md:12,className:E.formContent},a.createElement(h.A,{elevation:0},r))))))}A.propTypes={title:P().element.isRequired,children:P().element.isRequired};const v=A;var b=r(33850),x=r(51989),M=r(84712),S=r(85877),O=r(68738);function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const F="ChangePassword",N={mandatoryStarText:`${F}-mandatoryStarText`,passwordChangeForm:`${F}-passwordChangeForm`},$=(0,s.Ay)(v)((e=>{let{theme:t}=e;return{[`& .${N.mandatoryStarText}`]:{"& label>span:nth-child(1)":{color:"red"}},[`& .${N.passwordChangeForm}`]:{"& > span, & div, & p, & input":{color:t.palette.getContrastText(t.palette.primary.main)}}}}));function q(e,t){let{field:r,value:a}=t;return j(j({},e),{},{[r]:a})}const R=()=>{const{settings:{IsPasswordChangeEnabled:e,userStorePasswordPattern:t,passwordPolicyPattern:r,passwordPolicyMinLength:s,passwordPolicyMaxLength:d}}=(0,O.Mp)(),l=o.A.getUser().name,[h,f]=(0,a.useReducer)(q,{currentPassword:void 0,newPassword:void 0,repeatedNewPassword:void 0}),{currentPassword:P,newPassword:y,repeatedNewPassword:E}=h,C=i().passwordChange.guidelinesEnabled;let A=[];C&&(A=i().passwordChange.policyList);const v=()=>{let e=c().string().empty();s&&-1!==s&&(e=e.min(s)),d&&-1!==d&&(e=e.max(d));const o=e.validate(y).error;if(o){const e=o.details[0].type;if("string.empty"===e)return a.createElement(n.A,{id:"Change.Password.password.empty",defaultMessage:"Password is empty"});if("string.min"===e)return a.createElement(n.A,{id:"Change.Password.password.length.short",defaultMessage:"Password is too short!"});if("string.max"===e)return a.createElement(n.A,{id:"Change.Password.password.length.long",defaultMessage:"Password is too long!"})}if(t){const e=c().string().pattern(new RegExp(t)).validate(y).error;if(e&&"string.pattern.base"===e.details[0].type)return a.createElement(n.A,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"})}if(r){const e=c().string().pattern(new RegExp(r)).validate(y).error;if(e&&"string.pattern.base"===e.details[0].type)return a.createElement(n.A,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"})}return!1},T=()=>{if(E&&y!==E)return a.createElement(n.A,{id:"Change.Password.password.mismatch",defaultMessage:"Password doesn't match"})},j=e=>{let{target:{name:t,value:r}}=e;f({field:t,value:r})},k=a.createElement(a.Fragment,null,a.createElement(g.A,{variant:"h5",component:"h1"},a.createElement(n.A,{id:"Change.Password.title",defaultMessage:"Change Password"}),": "+l),a.createElement(g.A,{variant:"caption"},a.createElement(n.A,{id:"Change.Password.description",defaultMessage:"Change your own password. Required fields are marked with an asterisk ( * )"})),C&&A.length>0?a.createElement(g.A,{variant:"body2"},a.createElement(n.A,{id:"Change.Password.password.policy",defaultMessage:"Password policy:"}),a.createElement("ul",{style:{marginTop:"-4px",marginBottom:"-8px"}},A.map((e=>a.createElement("li",null,e))))):null);return void 0===e?a.createElement(S.A,null):e?a.createElement($,{title:k},a.createElement(m.A,{py:2,display:"flex",justifyContent:"center"},a.createElement(p.Ay,{item:!0,xs:10,md:9},a.createElement(m.A,{component:"div",m:2},a.createElement(p.Ay,{container:!0,mt:2,spacing:2,direction:"column",justifyContent:"center",alignItems:"flex-start"},a.createElement(u.A,{classes:{root:N.mandatoryStarText},required:!0,id:"current-password",autoFocus:!0,margin:"dense",name:"currentPassword",value:P,onChange:j,label:a.createElement(n.A,{id:"Settings.ChangePasswordForm.current.password",defaultMessage:"Current Password"}),fullWidth:!0,error:""===P,helperText:a.createElement(n.A,{id:"Settings.ChangePasswordForm.enter.current.password",defaultMessage:"Enter Current Password"}),variant:"outlined",type:"password"}),a.createElement(u.A,{classes:{root:N.mandatoryStarText},margin:"dense",id:"new-password",name:"newPassword",value:y,onChange:j,label:a.createElement(n.A,{id:"Settings.ChangePasswordForm.new.password",defaultMessage:"New Password"}),required:!0,fullWidth:!0,error:v(),helperText:v()||a.createElement(n.A,{id:"Settings.ChangePasswordForm.enter.new.password",defaultMessage:"Enter a New Password"}),variant:"outlined",type:"password"}),a.createElement(u.A,{classes:{root:N.mandatoryStarText},margin:"dense",id:"repeated-new-password",name:"repeatedNewPassword",value:E,onChange:j,label:a.createElement(n.A,{id:"Settings.ChangePasswordForm.confirm.new.password",defaultMessage:"Confirm new Password"}),required:!0,fullWidth:!0,error:T(),helperText:T()||a.createElement(n.A,{id:"Settings.ChangePasswordForm.confirmationOf.new.password",defaultMessage:"Confirmation of new Password"}),variant:"outlined",type:"password"}),a.createElement(m.A,{my:2,display:"flex",flexDirection:"row"},a.createElement(m.A,{mr:1},a.createElement(w.A,{color:"primary",variant:"contained",onClick:()=>{if(!E||y===E)return(new x.A).changePassword(P,y).then((e=>{M.A.success(a.createElement(n.A,{id:"Change.Password.password.changed.success",defaultMessage:"User password changed successfully. Please use the new password on next sign in"})),window.history.back()})).catch((e=>{switch(e.response.body.code){case 901450:M.A.error(a.createElement(n.A,{id:"Change.Password.password.change.disabled",defaultMessage:"Password change disabled"}));break;case 901451:M.A.error(a.createElement(n.A,{id:"Change.Password.current.password.incorrect",defaultMessage:"Current password is incorrect"}));break;case 901452:M.A.error(a.createElement(n.A,{id:"Change.Password.password.pattern.invalid",defaultMessage:"Invalid password pattern"}))}}));M.A.error(a.createElement(n.A,{id:"Change.Password.password.mismatch",defaultMessage:"Password doesn't match"}))},className:N.passwordChangeForm,"data-testid":"change-password-save-button"},a.createElement(n.A,{id:"Settings.ChangePasswordForm.Save.Button.text",defaultMessage:"Save"}))),a.createElement(m.A,{mx:1},a.createElement(w.A,{onClick:()=>window.history.back()},a.createElement(n.A,{id:"Settings.ChangePasswordForm.Cancel.Button.text",defaultMessage:"Cancel"}))))))))):a.createElement(b.A,null)}}}]);
//# sourceMappingURL=7100.1784c2f54a40d327ca21.bundle.js.map